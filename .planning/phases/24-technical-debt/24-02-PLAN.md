---
phase: 24-technical-debt
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/staff/page.tsx
  - apps/web/src/app/staff/dashboard/page.tsx
  - apps/web/src/app/staff/schedule/page.tsx
  - apps/web/src/app/staff/profile/page.tsx
  - apps/web/src/app/staff/earnings/page.tsx
  - apps/web/src/app/staff/time-off/page.tsx
  - apps/web/src/app/staff/login/page.tsx
  - apps/web/src/app/staff/setup/page.tsx
  - apps/web/src/components/staff/StaffHeader.tsx
autonomous: true

must_haves:
  truths:
    - "All staff portal text meets WCAG 2.1 AA contrast requirements"
    - "No charcoal/50, /60, /70 opacity modifiers remain in staff portal text classes"
    - "Staff portal maintains visual consistency with migrated owner portal"
  artifacts:
    - path: "apps/web/src/app/staff/dashboard/page.tsx"
      provides: "Staff dashboard with compliant contrast"
      contains: "text-text-secondary"
    - path: "apps/web/src/app/staff/earnings/page.tsx"
      provides: "Earnings page with compliant contrast"
      contains: "text-text-secondary"
  key_links:
    - from: "Staff portal pages"
      to: "tailwind.config.ts text tokens"
      via: "Tailwind class compilation"
      pattern: "text-text-(primary|secondary|muted)"
---

<objective>
Complete contrast migration for staff portal pages to achieve full WCAG 2.1 AA compliance.

Purpose: Resolve remaining DEBT-02 instances in staff portal. Plan 24-01 handles owner-facing pages; this plan completes the migration by handling all staff portal pages and the StaffHeader component. Combined, both plans eliminate all ~497 low-contrast text patterns.

Output: Staff portal uses identical semantic text tokens as owner portal, with guaranteed 4.5:1+ contrast ratios.
</objective>

<execution_context>
@C:\Users\aaron\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aaron\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-technical-debt/24-RESEARCH.md
@apps/web/tailwind.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Staff Portal Core Pages Contrast</name>
  <files>
    apps/web/src/app/staff/page.tsx
    apps/web/src/app/staff/dashboard/page.tsx
    apps/web/src/app/staff/schedule/page.tsx
    apps/web/src/app/staff/profile/page.tsx
  </files>
  <action>
    Search and replace low-contrast text patterns in staff portal core pages:

    Migration mapping:
    - text-charcoal/70 → text-charcoal (already 7:1+, just remove opacity)
    - text-charcoal/60 → text-text-secondary (#4A4A4A, 9:1 contrast)
    - text-charcoal/50 → text-text-muted (#7A7A7A, 4.6:1 contrast)

    File-specific counts (from research):
    - staff/page.tsx: ~28 instances (14 charcoal/60, 10 charcoal/50, 4 charcoal/70)
    - staff/dashboard/page.tsx: ~28 instances (22 charcoal/60, 6 charcoal/50)
    - staff/schedule/page.tsx: ~18 instances (17 charcoal/60, 1 charcoal/50)
    - staff/profile/page.tsx: ~13 instances (12 charcoal/60, 1 charcoal/50)

    For each file:
    1. Replace all instances of `text-charcoal/70` with `text-charcoal`
    2. Replace all instances of `text-charcoal/60` with `text-text-secondary`
    3. Replace all instances of `text-charcoal/50` with `text-text-muted`

    DO NOT change:
    - bg-charcoal/* (background opacity is fine)
    - border-charcoal/* (border opacity is fine)
    - Intentionally dimmed states (disabled elements)
  </action>
  <verify>
    Run: grep -rE "text-charcoal/(50|60|70)" apps/web/src/app/staff/{page,dashboard/page,schedule/page,profile/page}.tsx
    Expected: No matches (all patterns migrated)
  </verify>
  <done>
    Staff portal core pages (landing, dashboard, schedule, profile) use semantic text tokens.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate Staff Feature Pages and Header</name>
  <files>
    apps/web/src/app/staff/earnings/page.tsx
    apps/web/src/app/staff/time-off/page.tsx
    apps/web/src/app/staff/login/page.tsx
    apps/web/src/app/staff/setup/page.tsx
    apps/web/src/components/staff/StaffHeader.tsx
  </files>
  <action>
    Search and replace low-contrast text patterns in staff feature pages and shared header:

    Migration mapping (same as Task 1):
    - text-charcoal/70 → text-charcoal
    - text-charcoal/60 → text-text-secondary
    - text-charcoal/50 → text-text-muted

    File-specific counts (from research):
    - staff/earnings/page.tsx: ~20 instances (9 charcoal/60, 1 charcoal/50, 10 charcoal/70)
    - staff/time-off/page.tsx: ~8 instances (7 charcoal/60, 1 charcoal/70)
    - staff/login/page.tsx: ~7 instances (6 charcoal/60, 1 charcoal/70)
    - staff/setup/page.tsx: ~5 instances (5 charcoal/60)
    - StaffHeader.tsx: ~3 instances (2 charcoal/60, 1 charcoal/70)

    For each file, apply same replacement rules.

    StaffHeader is used on every staff portal page, so this fix has high visibility.
  </action>
  <verify>
    Run: grep -rE "text-charcoal/(50|60|70)" apps/web/src/app/staff/{earnings,time-off,login,setup}/page.tsx apps/web/src/components/staff/StaffHeader.tsx
    Expected: No matches

    Final verification across entire staff portal:
    Run: grep -rE "text-charcoal/(50|60|70)" apps/web/src/app/staff apps/web/src/components/staff --include="*.tsx"
    Expected: No matches
  </verify>
  <done>
    All staff feature pages and StaffHeader component use semantic text tokens.
  </done>
</task>

<task type="auto">
  <name>Task 3: Final Verification and Cleanup</name>
  <files>
    apps/web/src (verification only)
    apps/web/tailwind.config.ts (update comments if needed)
  </files>
  <action>
    Comprehensive verification that all text contrast patterns are migrated:

    1. Run full codebase scan for remaining low-contrast patterns:
       grep -rE "text-charcoal/(50|60|70)" apps/web/src --include="*.tsx"

    2. Expected results:
       - tailwind.config.ts: 3 matches (in comments documenting the deprecated pattern) - OK
       - All other files: 0 matches

    3. If any unexpected matches found:
       - Identify the file and pattern
       - Apply same migration mapping
       - Re-verify

    4. Run build to ensure no TypeScript errors:
       npm run build (in apps/web)

    5. Update tailwind.config.ts comment (line 63) to mark migration complete:
       Change: "AVOID: text-charcoal/50, text-charcoal/60, text-charcoal/70 (fail contrast)"
       To: "DEPRECATED: text-charcoal/50, text-charcoal/60, text-charcoal/70 - migrated to semantic tokens (Phase 24)"
  </action>
  <verify>
    Run: npm run build (in apps/web)
    Expected: Build succeeds with no TypeScript errors

    Run: grep -rE "text-charcoal/(50|60|70)" apps/web/src --include="*.tsx" | wc -l
    Expected: 0 (zero instances outside tailwind.config.ts comments)
  </verify>
  <done>
    Complete verification confirms zero low-contrast text patterns remain in application code. Build passes. DEBT-02 fully resolved.
  </done>
</task>

</tasks>

<verification>
1. Pattern elimination: `grep -rE "text-charcoal/(50|60|70)" apps/web/src --include="*.tsx"` returns only tailwind.config.ts comment
2. Build check: `npm run build` in apps/web passes
3. Visual consistency: Staff portal pages maintain same visual hierarchy as before (primary → secondary → muted text)
4. WCAG compliance: All text now uses tokens with guaranteed 4.5:1+ contrast ratios
</verification>

<success_criteria>
- Zero instances of text-charcoal/50, /60, /70 in staff portal pages
- Zero instances in shared components
- All migrated text uses text-text-primary, text-text-secondary, or text-text-muted
- Build passes without errors
- Staff portal visually consistent with owner portal
</success_criteria>

<output>
After completion, create `.planning/phases/24-technical-debt/24-02-SUMMARY.md`
</output>
