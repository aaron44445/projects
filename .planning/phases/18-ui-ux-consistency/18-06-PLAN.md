---
phase: 18-ui-ux-consistency
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/clients/page.tsx
  - apps/web/src/app/dashboard/page.tsx
  - apps/web/src/app/calendar/page.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Clients page modal uses packages/ui Modal component"
    - "Dashboard Activity modal uses packages/ui Modal component"
    - "Calendar page modals use packages/ui Modal component"
    - "No custom fixed inset-0 z-50 modal patterns in these files"
  artifacts:
    - path: "apps/web/src/app/clients/page.tsx"
      provides: "Clients page with Modal component"
      contains: "import { Modal }"
    - path: "apps/web/src/app/dashboard/page.tsx"
      provides: "Dashboard with Modal component"
      contains: "import { Modal }"
    - path: "apps/web/src/app/calendar/page.tsx"
      provides: "Calendar with Modal component"
      contains: "import { Modal }"
  key_links:
    - from: "apps/web/src/app/clients/page.tsx"
      to: "@peacase/ui Modal"
      via: "import"
      pattern: "from '@peacase/ui'"
---

<objective>
Migrate clients, dashboard, and calendar page modals to packages/ui Modal component

Purpose: Close Gap 1 (UI-01) part 1 - migrate 3 simpler pages with modals
Output: 3 pages using packages/ui Modal instead of custom implementations
</objective>

<execution_context>
@C:\Users\aaron\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aaron\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-ui-ux-consistency/18-02-SUMMARY.md

@packages/ui/src/components/Modal.tsx
@apps/web/src/components/BookingModal.tsx (reference - already migrated)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate clients page modal</name>
  <files>apps/web/src/app/clients/page.tsx</files>
  <action>
    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find the custom modal pattern:
       ```tsx
       {showModal && (
         <div className="fixed inset-0 z-50 flex items-center justify-center">
           <div className="absolute inset-0 bg-charcoal/50 backdrop-blur-sm" onClick={...} />
           <div className="relative ... rounded-2xl shadow-card-xl">
             {/* header */}
             {/* content */}
           </div>
         </div>
       )}
       ```
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showModal}
         onClose={() => setShowModal(false)}
         title="Modal Title"
         size="md"
       >
         {/* content only, Modal handles header */}
       </Modal>
       ```
    4. Remove any manual FocusTrap wrapper (Modal has built-in)
    5. Remove manual escape key handler (Modal handles it)
    6. Remove backdrop click handler (Modal handles it)
    7. Move form content directly into Modal children
    8. If there's a custom header (X button, title), use Modal's title/description props
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/clients/page.tsx returns no results
    - grep "from '@peacase/ui'" apps/web/src/app/clients/page.tsx returns Modal import
    - grep -A5 "<Modal" apps/web/src/app/clients/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Clients page uses packages/ui Modal, no custom modal implementation</done>
</task>

<task type="auto">
  <name>Task 2: Migrate dashboard Activity modal</name>
  <files>apps/web/src/app/dashboard/page.tsx</files>
  <action>
    1. Add Modal to existing @peacase/ui import: `import { EmptyState, Modal } from '@peacase/ui';`
    2. Find the custom Activity modal pattern (Quick Add Client modal and any other modals)
    3. Replace each custom modal with Modal component:
       ```tsx
       <Modal
         isOpen={showAddClient}
         onClose={() => setShowAddClient(false)}
         title="Quick Add Client"
         size="md"
       >
         {/* form content */}
       </Modal>
       ```
    4. For each modal:
       - Remove manual backdrop div
       - Remove manual close button (Modal provides one)
       - Move form fields/buttons into Modal children
       - Use Modal's title prop for header text
    5. Remove any manual escape handlers for modals
    6. Keep action buttons in a footer div inside children with border-t
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/dashboard/page.tsx returns no results
    - grep "Modal" apps/web/src/app/dashboard/page.tsx shows Modal usage
    - grep -A5 "<Modal" apps/web/src/app/dashboard/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Dashboard page uses packages/ui Modal for all modals</done>
</task>

<task type="auto">
  <name>Task 3: Migrate calendar page modals</name>
  <files>apps/web/src/app/calendar/page.tsx</files>
  <action>
    Calendar has multiple modals (New Appointment, Edit Appointment). For each:

    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find each custom modal with fixed inset-0 z-50 pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showNewAppointment}
         onClose={() => setShowNewAppointment(false)}
         title="New Appointment"
         size="lg"
       >
         {/* appointment form */}
       </Modal>
       ```
    4. For each modal:
       - Remove outer fixed/backdrop wrapper
       - Remove manual X button (Modal provides one)
       - Move all form content to Modal children
       - Keep footer buttons inside children
    5. Size guidance:
       - Simple dialogs: size="md"
       - Forms with multiple fields: size="lg"
       - Large detailed views: size="xl"
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/calendar/page.tsx returns no results
    - grep "from '@peacase/ui'" apps/web/src/app/calendar/page.tsx includes Modal
    - grep -A5 "<Modal" apps/web/src/app/calendar/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Calendar page uses packages/ui Modal for all modals</done>
</task>

</tasks>

<verification>
Run after all tasks:
```bash
# Verify no custom modal patterns remain
grep "fixed inset-0 z-50" apps/web/src/app/clients/page.tsx apps/web/src/app/dashboard/page.tsx apps/web/src/app/calendar/page.tsx

# Verify Modal imports present
grep "Modal" apps/web/src/app/clients/page.tsx apps/web/src/app/dashboard/page.tsx apps/web/src/app/calendar/page.tsx | grep "from '@peacase/ui'"

# TypeScript compilation
npm run typecheck
```
</verification>

<success_criteria>
- [ ] Clients page uses packages/ui Modal
- [ ] Dashboard page uses packages/ui Modal
- [ ] Calendar page uses packages/ui Modal for all modals
- [ ] No custom fixed inset-0 z-50 patterns in these files
- [ ] TypeScript compiles without errors
- [ ] Commit: feat(18-06): migrate clients, dashboard, calendar modals to packages/ui Modal
</success_criteria>

<output>
After completion, create `.planning/phases/18-ui-ux-consistency/18-06-SUMMARY.md`
</output>
