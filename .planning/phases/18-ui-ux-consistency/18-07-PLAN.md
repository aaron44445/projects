---
phase: 18-ui-ux-consistency
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/gift-cards/page.tsx
  - apps/web/src/app/locations/page.tsx
  - apps/web/src/app/marketing/page.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Gift-cards page modals use packages/ui Modal component"
    - "Locations page modals use packages/ui Modal component"
    - "Marketing page modal uses packages/ui Modal component"
    - "No custom fixed inset-0 z-50 modal patterns in these files"
  artifacts:
    - path: "apps/web/src/app/gift-cards/page.tsx"
      provides: "Gift cards with 4 Modal components"
      contains: "import { Modal }"
    - path: "apps/web/src/app/locations/page.tsx"
      provides: "Locations with 2 Modal components"
      contains: "import { Modal }"
    - path: "apps/web/src/app/marketing/page.tsx"
      provides: "Marketing with Modal component"
      contains: "import { Modal }"
  key_links:
    - from: "apps/web/src/app/gift-cards/page.tsx"
      to: "@peacase/ui Modal"
      via: "import"
---

<objective>
Migrate gift-cards (4 modals), locations (2 modals), and marketing (1 modal) page modals to packages/ui Modal

Purpose: Close Gap 1 (UI-01) part 2 - migrate 3 more pages with multiple modals
Output: 3 pages totaling 7 modals using packages/ui Modal
</objective>

<execution_context>
@C:\Users\aaron\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aaron\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-ui-ux-consistency/18-02-SUMMARY.md

@packages/ui/src/components/Modal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate gift-cards page modals (4 modals)</name>
  <files>apps/web/src/app/gift-cards/page.tsx</files>
  <action>
    Gift-cards has 4 modals based on state: showModal, showRedeemModal, showBalanceModal, showDetailsModal

    1. Add import: `import { Modal } from '@peacase/ui';`
    2. For each modal, find the pattern:
       ```tsx
       {showXxxModal && (
         <div className="fixed inset-0 z-50 ...">
           <div className="absolute inset-0 bg-charcoal/50 backdrop-blur-sm" />
           <div className="relative ... rounded-2xl">
             {/* content */}
           </div>
         </div>
       )}
       ```
    3. Replace each with Modal component:
       - showModal (Create Gift Card): `<Modal isOpen={showModal} onClose={() => setShowModal(false)} title="Create Gift Card" size="md">`
       - showRedeemModal: `<Modal isOpen={showRedeemModal} onClose={() => setShowRedeemModal(false)} title="Redeem Gift Card" size="sm">`
       - showBalanceModal: `<Modal isOpen={showBalanceModal} onClose={() => setShowBalanceModal(false)} title="Check Balance" size="sm">`
       - showDetailsModal: `<Modal isOpen={showDetailsModal} onClose={() => setShowDetailsModal(false)} title="Gift Card Details" size="md">`
    4. For each:
       - Remove manual backdrop
       - Remove manual X button/close logic
       - Move content to Modal children
       - Keep action buttons in children
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/gift-cards/page.tsx returns no results
    - grep -c "<Modal" apps/web/src/app/gift-cards/page.tsx shows 4+ occurrences
    - grep -A5 "<Modal" apps/web/src/app/gift-cards/page.tsx | grep "isOpen=" shows Modals wired to state
    - npm run typecheck passes
  </verify>
  <done>Gift-cards page uses packages/ui Modal for all 4 modals</done>
</task>

<task type="auto">
  <name>Task 2: Migrate locations page modals (2 modals)</name>
  <files>apps/web/src/app/locations/page.tsx</files>
  <action>
    Locations has 2 modals (Add Location, Edit Location or similar):

    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find each custom modal pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showAddLocation}
         onClose={() => setShowAddLocation(false)}
         title="Add Location"
         size="lg"
       >
         {/* location form */}
       </Modal>
       ```
    4. For edit modal, use dynamic title based on editing state
    5. Remove all manual modal infrastructure (backdrop, X button, escape handler)
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/locations/page.tsx returns no results
    - grep -c "<Modal" apps/web/src/app/locations/page.tsx shows 2+ occurrences
    - grep -A5 "<Modal" apps/web/src/app/locations/page.tsx | grep "isOpen=" shows Modals wired to state
    - npm run typecheck passes
  </verify>
  <done>Locations page uses packages/ui Modal for both modals</done>
</task>

<task type="auto">
  <name>Task 3: Migrate marketing page modal</name>
  <files>apps/web/src/app/marketing/page.tsx</files>
  <action>
    Marketing has 1 modal:

    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find the custom modal pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showModal}
         onClose={() => setShowModal(false)}
         title="Campaign Details"
         size="lg"
       >
         {/* campaign content */}
       </Modal>
       ```
    4. Remove manual modal infrastructure
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/marketing/page.tsx returns no results
    - grep "<Modal" apps/web/src/app/marketing/page.tsx shows Modal usage
    - grep -A5 "<Modal" apps/web/src/app/marketing/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Marketing page uses packages/ui Modal</done>
</task>

</tasks>

<verification>
Run after all tasks:
```bash
# Verify no custom modal patterns remain
grep "fixed inset-0 z-50" apps/web/src/app/gift-cards/page.tsx apps/web/src/app/locations/page.tsx apps/web/src/app/marketing/page.tsx

# Verify Modal imports present
grep "from '@peacase/ui'" apps/web/src/app/gift-cards/page.tsx apps/web/src/app/locations/page.tsx apps/web/src/app/marketing/page.tsx

# TypeScript compilation
npm run typecheck
```
</verification>

<success_criteria>
- [ ] Gift-cards page uses packages/ui Modal for all 4 modals
- [ ] Locations page uses packages/ui Modal for both modals
- [ ] Marketing page uses packages/ui Modal
- [ ] No custom fixed inset-0 z-50 patterns in these files
- [ ] TypeScript compiles without errors
- [ ] Commit: feat(18-07): migrate gift-cards, locations, marketing modals to packages/ui Modal
</success_criteria>

<output>
After completion, create `.planning/phases/18-ui-ux-consistency/18-07-SUMMARY.md`
</output>
