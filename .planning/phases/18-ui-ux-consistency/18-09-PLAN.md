---
phase: 18-ui-ux-consistency
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/staff/page.tsx
  - apps/web/src/app/staff/schedule/page.tsx
  - apps/web/src/app/staff/time-off/page.tsx
  - apps/web/src/app/portal/data/page.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Staff page modals use packages/ui Modal component"
    - "Staff schedule page modal uses packages/ui Modal component"
    - "Staff time-off page modal uses packages/ui Modal component"
    - "Portal data page modal uses packages/ui Modal component"
    - "No custom fixed inset-0 z-50 modal patterns in these files"
  artifacts:
    - path: "apps/web/src/app/staff/page.tsx"
      provides: "Staff with Modal components"
      contains: "import { Modal }"
    - path: "apps/web/src/app/staff/schedule/page.tsx"
      provides: "Schedule with Modal component"
      contains: "import { Modal }"
    - path: "apps/web/src/app/staff/time-off/page.tsx"
      provides: "Time-off with Modal component"
      contains: "import { Modal }"
    - path: "apps/web/src/app/portal/data/page.tsx"
      provides: "Portal data with Modal component"
      contains: "import { Modal }"
  key_links:
    - from: "apps/web/src/app/staff/page.tsx"
      to: "@peacase/ui Modal"
      via: "import"
---

<objective>
Migrate staff, staff/schedule, staff/time-off, and portal/data page modals to packages/ui Modal

Purpose: Close Gap 1 (UI-01) part 4 - migrate remaining 4 pages with modals
Output: 4 pages using packages/ui Modal, completing modal migration
</objective>

<execution_context>
@C:\Users\aaron\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aaron\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-ui-ux-consistency/18-02-SUMMARY.md

@packages/ui/src/components/Modal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate staff page modals</name>
  <files>apps/web/src/app/staff/page.tsx</files>
  <action>
    Staff page has multiple modals AND uses FocusTrap already. Modal component has FocusTrap built-in.

    1. Update existing @peacase/ui import to include Modal:
       `import { EmptyState, Modal } from '@peacase/ui';`
    2. REMOVE the manual FocusTrap import: `import FocusTrap from 'focus-trap-react';`
    3. Find custom modals using FocusTrap wrapper:
       ```tsx
       <FocusTrap active={showModal}>
         <div className="fixed inset-0 z-50 ...">
           ...
         </div>
       </FocusTrap>
       ```
    4. Replace each with Modal component:
       ```tsx
       <Modal
         isOpen={showNewStaff}
         onClose={() => setShowNewStaff(false)}
         title="Add Staff Member"
         size="lg"
       >
         {/* staff form */}
       </Modal>
       ```
    5. Handle location assignment modal, delete confirm modal similarly
    6. Remove ARIA ID generation code if Modal handles it (useId for titleId, etc.)
    7. Modal provides: FocusTrap, escape handler, ARIA labeling, backdrop click
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/staff/page.tsx returns no results
    - grep "FocusTrap" apps/web/src/app/staff/page.tsx returns no results (removed)
    - grep -c "<Modal" apps/web/src/app/staff/page.tsx shows modal occurrences
    - grep -A5 "<Modal" apps/web/src/app/staff/page.tsx | grep "isOpen=" shows Modals wired to state
    - npm run typecheck passes
  </verify>
  <done>Staff page uses packages/ui Modal, FocusTrap removed</done>
</task>

<task type="auto">
  <name>Task 2: Migrate staff/schedule page modal</name>
  <files>apps/web/src/app/staff/schedule/page.tsx</files>
  <action>
    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find custom modal pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showModal}
         onClose={() => setShowModal(false)}
         title="Schedule Details"
         size="md"
       >
         {/* schedule content */}
       </Modal>
       ```
    4. Remove manual modal infrastructure
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/staff/schedule/page.tsx returns no results
    - grep "<Modal" apps/web/src/app/staff/schedule/page.tsx shows Modal usage
    - grep -A5 "<Modal" apps/web/src/app/staff/schedule/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Staff schedule page uses packages/ui Modal</done>
</task>

<task type="auto">
  <name>Task 3: Migrate staff/time-off and portal/data modals</name>
  <files>apps/web/src/app/staff/time-off/page.tsx, apps/web/src/app/portal/data/page.tsx</files>
  <action>
    For staff/time-off/page.tsx:
    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find custom modal pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showModal}
         onClose={() => setShowModal(false)}
         title="Time Off Request"
         size="md"
       >
         {/* time off content */}
       </Modal>
       ```

    For portal/data/page.tsx:
    1. Add import: `import { Modal } from '@peacase/ui';`
    2. Find custom modal pattern
    3. Replace with Modal component:
       ```tsx
       <Modal
         isOpen={showModal}
         onClose={() => setShowModal(false)}
         title="Data Details"
         size="md"
       >
         {/* data content */}
       </Modal>
       ```
    4. Remove manual modal infrastructure from both
  </action>
  <verify>
    - grep "fixed inset-0 z-50" apps/web/src/app/staff/time-off/page.tsx apps/web/src/app/portal/data/page.tsx returns no results
    - grep "<Modal" in both files shows Modal usage
    - grep -A5 "<Modal" apps/web/src/app/staff/time-off/page.tsx | grep "isOpen=" shows Modal wired to state
    - grep -A5 "<Modal" apps/web/src/app/portal/data/page.tsx | grep "isOpen=" shows Modal wired to state
    - npm run typecheck passes
  </verify>
  <done>Staff time-off and portal data pages use packages/ui Modal</done>
</task>

</tasks>

<verification>
Run after all tasks:
```bash
# Verify no custom modal patterns remain
grep "fixed inset-0 z-50" apps/web/src/app/staff/page.tsx apps/web/src/app/staff/schedule/page.tsx apps/web/src/app/staff/time-off/page.tsx apps/web/src/app/portal/data/page.tsx

# Verify FocusTrap removed from staff page
grep "import FocusTrap" apps/web/src/app/staff/page.tsx

# Verify Modal imports present
grep "from '@peacase/ui'" apps/web/src/app/staff/page.tsx apps/web/src/app/staff/schedule/page.tsx apps/web/src/app/staff/time-off/page.tsx apps/web/src/app/portal/data/page.tsx

# TypeScript compilation
npm run typecheck
```
</verification>

<success_criteria>
- [ ] Staff page uses packages/ui Modal, manual FocusTrap removed
- [ ] Staff schedule page uses packages/ui Modal
- [ ] Staff time-off page uses packages/ui Modal
- [ ] Portal data page uses packages/ui Modal
- [ ] No custom fixed inset-0 z-50 patterns in these files
- [ ] TypeScript compiles without errors
- [ ] Commit: feat(18-09): migrate staff, schedule, time-off, portal modals to packages/ui Modal
</success_criteria>

<output>
After completion, create `.planning/phases/18-ui-ux-consistency/18-09-SUMMARY.md`
</output>
