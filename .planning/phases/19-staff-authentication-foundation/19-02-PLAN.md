---
phase: 19-staff-authentication-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/staff/login/page.tsx
  - apps/web/src/contexts/StaffAuthContext.tsx
autonomous: true

must_haves:
  truths:
    - "Staff login page shows 'Remember me' checkbox"
    - "Login request includes rememberMe boolean based on checkbox state"
    - "Unchecked (default) state sends rememberMe: false"
    - "Checked state sends rememberMe: true"
  artifacts:
    - path: "apps/web/src/app/staff/login/page.tsx"
      provides: "Remember me checkbox on login form"
      contains: "rememberMe"
    - path: "apps/web/src/contexts/StaffAuthContext.tsx"
      provides: "Login function accepts rememberMe parameter"
      contains: "rememberMe"
  key_links:
    - from: "apps/web/src/app/staff/login/page.tsx"
      to: "StaffAuthContext.login"
      via: "login function call with rememberMe"
      pattern: "login.*rememberMe"
---

<objective>
Add "Remember me" checkbox to staff login page and wire it through to the authentication context.

Purpose: Staff can opt to stay logged in across browser sessions with a 30-day refresh token, or use the default 24-hour session.

Output: Updated login page with checkbox, updated auth context to pass rememberMe to API.
</objective>

<execution_context>
@C:\Users\aaron\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\aaron\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-staff-authentication-foundation/19-CONTEXT.md
@apps/web/src/app/staff/login/page.tsx
@apps/web/src/contexts/StaffAuthContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Remember Me checkbox to staff login page</name>
  <files>apps/web/src/app/staff/login/page.tsx</files>
  <action>
Update the staff login page to include a "Stay logged in on this device" checkbox:

1. Add state for rememberMe:
```typescript
const [rememberMe, setRememberMe] = useState(false);
```

2. Add checkbox between password field and submit button, styled to match the form:
```tsx
{/* Remember Me */}
<div className="flex items-center">
  <input
    id="rememberMe"
    type="checkbox"
    checked={rememberMe}
    onChange={(e) => setRememberMe(e.target.checked)}
    className="h-4 w-4 rounded border-charcoal/30 text-sage focus:ring-sage/20"
    disabled={isSubmitting}
  />
  <label htmlFor="rememberMe" className="ml-2 text-sm text-charcoal/70">
    Stay logged in on this device
  </label>
</div>
```

3. Update the handleSubmit to pass rememberMe to login:
```typescript
await login(email, password, rememberMe);
```

Note: The login function in StaffAuthContext currently has a third parameter `pin?: string`. We need to update this in Task 2.

Position the checkbox after the password field and before the submit button. The checkbox should be unchecked by default (per CONTEXT.md: "Unchecked (default): 24-hour session").
  </action>
  <verify>
Search the file for "rememberMe" - should find state and checkbox.
Search for "Stay logged in" - should find the label text.
  </verify>
  <done>
Staff login page shows "Stay logged in on this device" checkbox, unchecked by default.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update StaffAuthContext to pass rememberMe to API</name>
  <files>apps/web/src/contexts/StaffAuthContext.tsx</files>
  <action>
Update the StaffAuthContext to handle the rememberMe parameter:

1. Update the login function signature (currently has `pin?: string` as third param):
```typescript
login: (email: string, password: string, rememberMe?: boolean) => Promise<void>;
```

2. Update the login implementation to include rememberMe in the API request:
```typescript
const login = async (email: string, password: string, rememberMe?: boolean): Promise<void> => {
  const response = await api.post<StaffLoginResponse>('/staff-portal/auth/login', {
    email: email.toLowerCase().trim(),
    password,
    rememberMe: rememberMe ?? false,  // Default to false if not provided
  });
  // ... rest of implementation unchanged
};
```

3. Update the StaffAuthContextType interface:
```typescript
login: (email: string, password: string, rememberMe?: boolean) => Promise<void>;
```

Note: The old `pin` parameter can be removed if not used, or kept for future PIN authentication. Check if any code uses it - if so, keep backward compatibility.

The API will receive { email, password, rememberMe } and use rememberMe to determine refresh token expiry (30d vs 24h).
  </action>
  <verify>
Search for "rememberMe" in the context file.
Verify the login function accepts and passes the parameter.
Run type check to ensure no errors: `cd apps/web && npx tsc --noEmit`
  </verify>
  <done>
StaffAuthContext login function accepts rememberMe parameter and includes it in API request.
  </done>
</task>

</tasks>

<verification>
1. Search login page for "rememberMe" state and checkbox
2. Search context for rememberMe in login function
3. TypeScript compilation passes
4. Login page renders checkbox at correct position
</verification>

<success_criteria>
- [ ] Staff login page displays "Stay logged in on this device" checkbox
- [ ] Checkbox is unchecked by default
- [ ] Checking the checkbox sends rememberMe: true to API
- [ ] Leaving unchecked sends rememberMe: false to API
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/19-staff-authentication-foundation/19-02-SUMMARY.md`
</output>
